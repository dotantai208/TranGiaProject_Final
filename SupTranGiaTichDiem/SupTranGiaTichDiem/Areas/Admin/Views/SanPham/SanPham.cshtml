@model IEnumerable<SupTranGiaTichDiem.Models.Reward>

@{
    ViewBag.Title = "SanPham";
    Layout = "~/Areas/Admin/Views/Shared/Layout.cshtml";
    ViewBag.active = 7;
}


<!-- Content wrapper -->
<div class="content-wrapper">
    <div class="container-xxl flex-grow-1 container-p-y">
        <div class="row pb-3">
            <div class="d-flex mb-2 text-light">
                <div class="p-2">
                    <button type="submit" class="btn btn-warning" data-bs-toggle="modal"
                            data-bs-target="#exLargeModal">
                        <span class="tf-icons bx bx-plus-medical"></span>&nbsp;Thêm sản phẩm
                    </button>
                </div>

                <a href="@Url.Action("SanPhamDoAn", "SanPham", new { area = "Admin" })">Đồ ăn</a>
                <a href="@Url.Action("SanPhamDoUong", "SanPham", new { area = "Admin" })">Đồ uống</a>

                <div class="ms-auto p-2">
                    <select class="form-select" aria-label="Default select example">
                        <option value="0">Mặc định </option>
                        <option value="1">Đồ ăn</option>
                        <option value="2">Đồ uống</option>


                    </select>
                </div>
            </div>
        </div>


        <div class="card">

            <div class="pt-4 card-header col-md-4">
                <div class="input-group">
                    <input type="search" class="form-control " placeholder="Search" aria-label="Search" aria-describedby="search-addon" />
                    <button type="button" class="btn btn-outline-primary" data-mdb-ripple-init>Tìm kiếm</button>
                </div>
            </div>
            <div class="table-responsive text-nowrap card-body">
                <table class="table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Hình ảnh</th>
                            <th>Tên sản phẩm</th>
                            <th>Điểm thưởng</th>
                            <th>Ngày tạo</th>
                            <th>Trạng thái</th>
                            <th>Thao tác</th>
                        </tr>
                    </thead>
                    <tbody class="table-border-bottom-0">

                        @foreach (var item in Model)
                        {
                            <tr>
                                <td><strong>@item.reward_id</strong></td>
                                <td style="width: 50px; height: 80px;"><img src="~/img/image-SanPham/@item.reward_image" alt="" class="img-fluid"></td>
                                <td>
                                    @item.reward_name
                                </td>
                                <td>
                                    @item.points_required
                                </td>
                                <td>@item.reward_date</td>

                                @if (item.status == true)
                                {


                                    <td><span class="badge bg-label-success me-1">Đã đăng</span></td>

                                }
                                else
                                {
                                    <td><span class="badge bg-label-danger me-1">Chưa đăng</span></td>
                                }

                                <td>
                                    <button type="button" class="btn btn-icon btn-warning open-reward-modal" data-id="@item.reward_id">
                                        <span class="tf-icons"><i class='bx bx-edit'></i></span>
                                    </button>


                                    <button type="button" class="btn  btn-icon btn-danger open-account-modal-delete" onclick="xoa()" data-id="@item.reward_id">
                                        <span class="tf-icons"><i class='bx bx-trash'></i></span>
                                    </button>
                                </td>
                            </tr>

                        }


                    </tbody>
                </table>
            </div>

        </div>
        <div class="demo-inline-spacing ">
            <!-- Basic Pagination -->
            <nav aria-label="Page navigation ">
                <ul class="pagination justify-content-center align-items-center">
                    <li class="page-item first">
                        <a class="page-link" href="javascript:void(0);">
                            <i class="tf-icon bx bx-chevrons-left"></i>
                        </a>
                    </li>
                    <li class="page-item prev">
                        <a class="page-link" href="javascript:void(0);">
                            <i class="tf-icon bx bx-chevron-left"></i>
                        </a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="javascript:void(0);">1</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="javascript:void(0);">2</a>
                    </li>
                    <li class="page-item active ">
                        <a class="page-link bg-warning" href="javascript:void(0);">3</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="javascript:void(0);">4</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="javascript:void(0);">5</a>
                    </li>
                    <li class="page-item next">
                        <a class="page-link" href="javascript:void(0);">
                            <i class="tf-icon bx bx-chevron-right"></i>
                        </a>
                    </li>
                    <li class="page-item last">
                        <a class="page-link" href="javascript:void(0);">
                            <i class="tf-icon bx bx-chevrons-right"></i>
                        </a>
                    </li>
                </ul>
            </nav>
            <!--/ Basic Pagination -->
        </div>
        <!--/ Responsive Table -->
    </div>


    <!-- Thêm sản phẩm-->
    <div class="modal fade" id="exLargeModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel4">Thêm Sản phẩm</h5>
                    <button type="button"
                            class="btn-close"
                            data-bs-dismiss="modal"
                            aria-label="Close"></button>
                </div>
                @using (Html.BeginForm("createSP", "SanPham", FormMethod.Post, new { enctype = "multipart/form-data" }))
                {
                    @Html.AntiForgeryToken()

                    <div class="modal-body">

                        <div class="row">
                            <div class="col-lg-4">
                                <div class="card">

                                    <div class="card-body text-center">
                                        <div class="button-wrapper">
                                            <label for="upload" class="btn btn-primary me-2 mb-4" tabindex="0">
                                                <span class="d-none d-sm-block">Thêm ảnh mới</span>
                                                <i class="bx bx-upload d-block d-sm-none"></i>
                                                <input type="file"
                                                       id="upload"
                                                       name="fileAnh"
                                                       class="account-file-input img-fluid"
                                                       hidden
                                                       accept="image/png, image/jpeg" />
                                            </label>
                                            <button type="button" class="btn btn-outline-secondary account-image-reset mb-4">
                                                <i class="bx bx-reset d-block d-sm-none"></i>
                                                <span class="d-none d-sm-block">Reset</span>
                                            </button>

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-8 ">
                                <div class="mb-3">
                                    <label for="exampleFormControlInput1" class="form-label">Tên sản phẩm</label>
                                    <input type="text"
                                           class="form-control"
                                           name="reward_name"
                                           id="exampleFormControlInput1"
                                           placeholder="Tên sản phẩm" />
                                </div>
                                <div class="mb-3">
                                    <label for="exampleFormControlInput1" class="form-label">Điểm thưởng</label>
                                    <input type="number"
                                           name="points_required"
                                           class="form-control"
                                           id="exampleFormControlInput1"
                                           placeholder="Điểm thưởng" />
                                </div>
                                <div class=" mb-3">
                                    <label for="exampleFormControlInput1" class="form-label">Ngày ra mắt</label>
                                    <input type="date"
                                           name="reward_date"
                                           class="form-control"
                                           id="exampleFormControlInput1"
                                           placeholder="" />
                                </div>
                                <div class="mb-3">
                                    <label for="exampleFormControlInput1" class="form-label">Số lượng</label>
                                    <input type="number"
                                           name="quantity"
                                           class="form-control"
                                           id="exampleFormControlInput1" />
                                </div>



                                <div class="mb-3 col-12">
                                    <div>
                                        <label for="exampleFormControlTextarea1" class="form-label">Nôi dung sản phẩm</label>
                                        <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"></textarea>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="defaultSelect" class="form-label">Loại sản phẩm</label>
                                    <select id="defaultSelect" name="category_id" class="form-select">
                                        <option>Hãy chọn loại </option>
                                        <option value="1">Đồ ăn</option>
                                        <option value="2">Đồ uống</option>

                                    </select>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                            Close
                        </button>
                        <button type="submit" class="btn btn-primary">Save changes</button>
                    </div>
                }
            </div>
        </div>
    </div>
    <!-- /END Thêm sản phẩm -->
    <!-- Cập nhật sản phẩm-->
    <div class="modal fade" id="modalUpdate_R" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel4">Cập nhật Sản phẩm</h5>
                    <button type="button"
                            class="btn-close"
                            data-bs-dismiss="modal"
                            aria-label="Close"></button>
                </div>
                @using (Html.BeginForm("updateSP", "SanPham", FormMethod.Post, new { enctype = "multipart/form-data" }))
                {
                    @Html.AntiForgeryToken()

                    <div class="modal-body">
                        <input name="reward_id" type="hidden" id="edit_ID_R" />
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="card">

                                    <div class="card-body text-center">
                                        <div class="button-wrapper">
                                            <label for="upload" class="btn btn-primary me-2 mb-4" tabindex="0">
                                                <span class="d-none d-sm-block">Thêm ảnh mới</span>
                                                <i class="bx bx-upload d-block d-sm-none"></i>
                                                <input type="file"
                                                       id="upload"
                                                       name="fileAnh"
                                                       class="account-file-input img-fluid"
                                                       hidden
                                                       accept="image/png, image/jpeg" />
                                            </label>
                                            <button type="button" class="btn btn-outline-secondary account-image-reset mb-4">
                                                <i class="bx bx-reset d-block d-sm-none"></i>
                                                <span class="d-none d-sm-block">Reset</span>
                                            </button>

                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="col-lg-8 ">
                                <div class="mb-3">
                                    <label for="exampleFormControlInput1" class="form-label">Tên sản phẩm</label>
                                    <input type="text"
                                           class="form-control"
                                           name="reward_name"
                                           id="edit_reward_name_R"
                                           placeholder="Tên sản Phẩm"
                                           required />
                                </div>
                                <div class="mb-3">
                                    <label for="exampleFormControlInput1" class="form-label">Điểm thưởng</label>
                                    <input type="number"
                                           name="points_required"
                                           class="form-control"
                                           id="edit_points_required_R"
                                           placeholder="Điểm thưởng"
                                           min="1"
                                           required />
                                </div>
                                <div class=" mb-3">
                                    <label for="exampleFormControlInput1" class="form-label">Ngày ra mắt</label>
                                    <input type="date"
                                           name="reward_date"
                                           class="form-control"
                                           id="edit_reward_date_R"
                                           required />
                                </div>
                                <div class="mb-3">
                                    <label for="exampleFormControlInput1" class="form-label">Số lượng</label>
                                    <input type="number"
                                           name="quantity"
                                           class="form-control"
                                           id="edit_quantity_R"
                                           min="1"
                                           required />
                                </div>



                                <div class="mb-3 col-12">
                                    <div>
                                        <label for="exampleFormControlTextarea1" class="form-label">Nôi dung sản phẩm</label>
                                        <textarea class="form-control" name="description" id="edit_description_R" rows="3"></textarea>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="defaultSelect" class="form-label">Loại sản phẩm</label>
                                    <select id="edit_category_id_R" name="category_id" class="form-select">
                                        <option>Hãy chọn loại </option>
                                        <option value="1">Đồ ăn</option>
                                        <option value="2">Đồ uống</option>

                                    </select>
                                </div>
                                <div class="mb-3">
                                    <h6>Trạng thái</h6>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="status" id="edit_status_R" value="true" />
                                        <label class="form-check-label" for="editRoleSP">Đã đăng</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="status" id="edit_status_R" value="false" />
                                        <label class="form-check-label" for="editRoleSP">Chưa đăng</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                            Close
                        </button>
                        <button type="submit" class="btn btn-primary">Lưu sản phẩm</button>
                    </div>
                }
            </div>
        </div>
    </div>


    <!-- /END Cập nhật sản phẩm -->
    <!-- Xóa tài khoản -->
    <div class="modal fade" id="modalDelete" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalUpdatetitle">Xóa Sản Phẩm</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                @using (Html.BeginForm("DeleteSP", "SanPham", FormMethod.Post))
                {
                    @Html.AntiForgeryToken()
                    <div class="modal-body">
                        <input name="reward_id" type="hidden" id="edit_ID_R_De" />

                        <div>Bạn có chắc muốn xóa sản phẩm này: <span class="text-danger" id="tenSanPham"></span> !!</div>


                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Thoát</button>
                        <button type="submit" class="btn btn-danger">Xóa</button>
                    </div>
                }

            </div>
        </div>
    </div>
    <!-- /END xóa tài khoản -->



</div>

<div class="content-backdrop fade"></div>


<!-- / Layout page -->
@if (!string.IsNullOrEmpty(Request.QueryString["message"]))
{
    <div class="alert alert-info">
        @Request.QueryString["message"]
    </div>
}


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $('.open-reward-modal').click(function () {
            var id = $(this).data('id');
            $.ajax({
                url: '@Url.Action("GetSanPham", "SanPham")',
                type: 'GET',
                data: { id: id },
                success: function (data) {
                    $('#edit_ID_R').val(data.ID_R);

                    $('#edit_reward_name_R').val(data.name_R);
                    $('#edit_points_required_R').val(data.point_R);
                    $('#edit_reward_date_R').val(data.date_R);

                    $('#edit_quantity_R').val(data.quantity_R);
                    $('#edit_description_R').val(data.description_R);
                    $('#edit_category_id_R').val(data.category_id_R);
                    $('#edit_status_R[value = "' + data.status_R + '"]').prop('checked', true);

                   // $('#editStatus').prop('checked', true);
                    // Đặt checked = true
                   // $('#editStatus').prop('checked', true);
                   // $('#editStatus').val(true);
                    // Đặt checked = false
                  //  $('#editStatus').prop('checked', false);
                   // $('#editStatus').val(false);

                    $('#modalUpdate_R').modal('show');
                },
                error: function () {
                    alert('Có lỗi xảy ra.');
                }
            });
        });
    });

</script>

<!-- Delete-->
<script type="text/javascript">
$(document).ready(function () {
    $('.open-account-modal-delete').click(function () {
        var id = $(this).data('id');

        $.ajax({
            url: '@Url.Action("GetSanPham", "SanPham")',
            type: 'GET',
            data: { id: id },
            success: function (data) {


                $('#edit_ID_R_De').val(data.ID_R);
                $('#tenSanPham').text(data.name_R);

               // $('#editStatus').prop('checked', true);
                // Đặt checked = true
               // $('#editStatus').prop('checked', true);
               // $('#editStatus').val(true);
                // Đặt checked = false
              //  $('#editStatus').prop('checked', false);
                // $('#editStatus').val(false);

                $('#modalDelete').modal('show');
            },
            error: function () {
                alert('Có lỗi xảy ra.');
            }
        });
    });

});
</script>
