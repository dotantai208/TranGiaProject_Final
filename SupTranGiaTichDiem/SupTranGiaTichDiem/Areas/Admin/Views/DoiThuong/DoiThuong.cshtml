@model List<SupTranGiaTichDiem.Models.RedemptionList>

@{
    ViewBag.Title = "DoiThuong";
    Layout = "~/Areas/Admin/Views/Shared/Layout.cshtml";
    ViewBag.active = 2;
}




<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

 

    <div class="container-xxl flex-grow-1 container-p-y">
        <div class="row pb-3">
            <div class="d-flex mb-2 text-light">



                <div class="ms-auto p-2">
                    <select class="form-select" aria-label="Default select example">
                        <option selected>Mặc định </option>
                        <option value="1">Đã xác nhận</option>
                        <option value="2">Chưa xác nhận</option>

                    </select>
                </div>
            </div>
        </div>


        <div class="card">

            <div class="pt-4 card-header col-md-4">
                <div class="input-group">
                    <input type="search" class="form-control " placeholder="Search" aria-label="Search" aria-describedby="search-addon" />
                    <button type="button" class="btn btn-outline-primary" data-mdb-ripple-init>Tìm kiếm</button>
                </div>
            </div>
            <div class="table-responsive text-nowrap card-body">
                <table class="table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Số điện thoại</th>
                            <th>Họ và tên</th>
                            <th>Điểm</th>
                            <th>Phần quà</th>
                            <th>Trạng thái</th>
                            <th>Xác nhận</th>
                        </tr>
                    </thead>
                    <tbody class="table-border-bottom-0">

                        @if (Model != null && Model.Any())
                        {
                            foreach (var item in Model)
                            {
                                <tr>
                                    <td><strong>@item.RedemptionId</strong></td>
                                    <td>@item.Phone</td>
                                    <td>@item.FullName</td>
                                    <td><span class="text-danger">- @item.PointsRequired</span></td>
                                    <td>@item.RewardName</td>
                                    <td>
                                        @if (item.Status == true)
                                        {


                                            <span class="badge bg-label-success me-1">Đã xác nhận</span>
                                        }
                                        else
                                        {
                                            <span class="badge bg-label-danger me-1">Chưa xác nhận</span>
                                        }
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-icon btn-warning btn-edit" data-bs-toggle="modal" data-bs-target="#modalUpdate">
                                            <span class="tf-icons"><i class='bx bx-edit'></i></span>
                                        </button>
                                    </td>
                                </tr>
                            }
                        }
                        else
                        {
                            <tr><td colspan="7">Không có dữ liệu để hiển thị</td></tr>
                        }




                    </tbody>
                </table>
            </div>
        </div>

        <div class="demo-inline-spacing ">
            <!-- Basic Pagination -->
            <nav aria-label="Page navigation ">
                <ul class="pagination justify-content-center align-items-center">
                    <li class="page-item first">
                        <a class="page-link" href="javascript:void(0);">
                            <i class="tf-icon bx bx-chevrons-left"></i>
                        </a>
                    </li>
                    <li class="page-item prev">
                        <a class="page-link" href="javascript:void(0);">
                            <i class="tf-icon bx bx-chevron-left"></i>
                        </a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="javascript:void(0);">1</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="javascript:void(0);">2</a>
                    </li>
                    <li class="page-item active ">
                        <a class="page-link bg-warning" href="javascript:void(0);">3</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="javascript:void(0);">4</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="javascript:void(0);">5</a>
                    </li>
                    <li class="page-item next">
                        <a class="page-link" href="javascript:void(0);">
                            <i class="tf-icon bx bx-chevron-right"></i>
                        </a>
                    </li>
                    <li class="page-item last">
                        <a class="page-link" href="javascript:void(0);">
                            <i class="tf-icon bx bx-chevrons-right"></i>
                        </a>
                    </li>
                </ul>
            </nav>
            <!--/ Basic Pagination -->
        </div>
        <!--/ Responsive Table -->
    </div>


    <div class="modal fade" id="modalCenter" tabindex="0" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered " role="document">
            <div class="modal-content">
                <div class="modal-header bg-warning ">
                    <h4 id="modalCenterTitle"> <b class="text-dark">Tạo nhanh tài khoản tích điểm</b></h4>
                    <button type="button"
                            class="btn-close"
                            data-bs-dismiss="modal"
                            aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-12 mb-3">
                            <label for="nameWithTitle" class="form-label">Số điện thoại</label>
                            <input type="text"
                                   id="nameWithTitle"
                                   class="form-control"
                                   placeholder="Nhập số điện thoại" />
                        </div>
                        <div class="col-12 mb-3">
                            <label for="nameWithTitle" class="form-label">Mật khẩu</label>
                            <input type="text"
                                   id="nameWithTitle"
                                   class="form-control"
                                   placeholder="Nhập mật khẩu"
                                   value="1" />
                        </div>
                        <div class="col-12 mb-3">
                            <label for="diem" class="form-label">Điểm</label>
                            <input type="number"
                                   id="diem"
                                   class="form-control"
                                   placeholder="Nhập điểm"
                                   value="0"
                                   min="0"
                                   onkeydown="return false;" />
                        </div>

                    </div>

                    <div class="col mt-3">
                        <h6> Vai trò</h6>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio1" value="option1" checked />
                            <label class="form-check-label" for="inlineRadio1">Khách hàng</label>
                        </div>

                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio2" value="option2" disabled />
                            <label class="form-check-label" for="inlineRadio2">Admin</label>
                        </div>


                    </div>
                    <div class="mt-3">
                        <label for="language" class="form-label">Khu vực</label>
                        <select id="language" class="select2 form-select">
                            <option value="">Chon khu vực</option>
                            <option value="en">Cần Thơ</option>
                            <option value="fr">Vĩnh Long</option>

                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                        Thoát
                    </button>
                    <button type="button" class="btn btn-warning create-btn">Tạo nhanh</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Update account-->
    <div class="modal fade" id="modalUpdate" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            @using (Html.BeginForm("CapNhat", "DoiThuong", FormMethod.Post))
            {
                @Html.AntiForgeryToken()
                <div class="modal-content">
                    <div class="modal-header bg-warning">
                        <h4 class="text-dark" id="modalUpdatetitle"><b>Đổi thưởng</b> </h4>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-12 mb-3">
                                <input name="red_acc_id" id="accID" type="hidden" value="" />
                                <label for="nameWithTitle" class="form-label">Số điện thoại</label>
                                <input type="text" id="phone" class="form-control" placeholder="Nhập số điện thoại" readonly />
                            </div>
                            <div class="col-12 mb-3">
                                <label for="nameWithTitle" class="form-label">Họ và tên</label>
                                <input type="text" id="fullname" class="form-control" placeholder="Nhập Họ và tên" readonly />
                            </div>
                            <div class="col-12 mb-3">
                                <h6>Trạng thái</h6>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="red_status" id="statusConfirmed" value="true">
                                    <label class="form-check-label" for="statusConfirmed">Đã xác nhận</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="red_status" id="statusUnconfirmed" value="false">
                                    <label class="form-check-label" for="statusUnconfirmed">Chưa xác nhận</label>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Thoát</button>
                            <button type="submit" class="btn btn-warning">Cập nhật</button>
                        </div>
                    </div>
                </div>
            }
        </div>
        <div class="content-backdrop fade"></div>
    </div>

    <script>
        $(document).ready(function () {
            $('.btn-edit').click(function (event) {
                var rowData = $(this).closest('tr').find('td');

                var accID = rowData.eq(0).text();
                var phone = rowData.eq(1).text();
                var fullname = rowData.eq(2).text();
                var statusText = rowData.eq(5).find('span').text();

                $('#accID').val(accID);
                $('#phone').val(phone);
                $('#fullname').val(fullname);

                if (statusText === "Đã xác nhận") {
                    $('#statusConfirmed').prop('checked', true);
                } else {
                    $('#statusUnconfirmed').prop('checked', true);
                }

                $('#modalUpdate').modal('show');
            });
        });
    </script>
