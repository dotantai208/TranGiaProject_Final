<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - Súp Trà Gia</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet" />
    <!-- MDB -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.3.0/mdb.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    @Styles.Render("~/css/style.css")
    @Styles.Render("~/css/card.css")
    @Styles.Render("~/css/starts.css")
    @Styles.Render("~/css/detail.css")
    @Styles.Render("~/css/slideShow.css")
    @Styles.Render("~/css/DropdownsCus.css")
    <link href="~/css/category.css" rel="stylesheet" />
    
    <script src="https://cdn.lordicon.com/lordicon.js"></script>
    <style>
        .dai {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .form-group{
            position: relative;
        }

        .toggle-password {
            position: absolute;
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
            cursor: pointer;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg   container">
        <div class="container-fluid">
            <a class="navbar-brand" href="#"><img src="~/img/logo_supTranGia.png" alt=""></a>
            <button data-mdb-collapse-init class="navbar-toggler text-light" type="button"
                    data-mdb-target="#navbarTogglerDemo02" aria-controls="navbarTogglerDemo02" aria-expanded="false"
                    aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        @Html.ActionLink("Trang chủ", "Index", "Home", new { area = "" }, new { @class = "nav-link ", aria_current = "page" })
                    </li>
                    <li class="nav-item">
                        @Html.ActionLink("Sản Phẩm", "ListSanPham", "Home", null, new { @class = "nav-link" })
                    </li>
                    <li class="nav-item">
                        @Html.ActionLink("Lịch sử tích điểm", "Index", "LichSuDiemCaNhan", null, new { @class = "nav-link" })
                    </li>
                    <li class="nav-item">
                        @Html.ActionLink("Đổi thưởng", "PhanThuong", "Home", null, new { @class = "nav-link" })
                    </li>
                    <li class="nav-item">
                        @Html.ActionLink("Tin tức", "Doithuong", "DanhSach", null, new { @class = "nav-link" })
                    </li>
                    <li class="nav-item">
                        

                            @Html.ActionLink("Giỏ hàng", "Index", "Wishlist", null, new { @class = "nav-link" })
                           
                    </li>
                </ul>



               
                 
                 <div class="d-flex align-items-start">
                    
                     @if (Request.Cookies["UserInfo"] == null)
                     {
                         <a data-mdb-ripple-init type="button" class="btn btn-link px-1 me-1 text-warning" href="~/DangNhap/login">
                             Đăng nhập
                         </a>
                         <a data-mdb-ripple-init type="button" class="btn btn-link px-1 me-1 text-warning" href="~/DangKy/Register">
                             Đăng ký
                         </a>
                     }
                     else
                     {

                         <label class="popup ">
                             <input type="checkbox" />
                             <div tabindex="0" class="burger">
                                 <svg viewBox="0 0 24 24"
                                      fill="dark"
                                      height="20"
                                      width="20"
                                      xmlns="http://www.w3.org/2000/svg">
                                     <path d="M12 2c2.757 0 5 2.243 5 5.001 0 2.756-2.243 5-5 5s-5-2.244-5-5c0-2.758 2.243-5.001 5-5.001zm0-2c-3.866 0-7 3.134-7 7.001 0 3.865 3.134 7 7 7s7-3.135 7-7c0-3.867-3.134-7.001-7-7.001zm6.369 13.353c-.497.498-1.057.931-1.658 1.302 2.872 1.874 4.378 5.083 4.972 7.346h-19.387c.572-2.29 2.058-5.503 4.973-7.358-.603-.374-1.162-.811-1.658-1.312-4.258 3.072-5.611 8.506-5.611 10.669h24c0-2.142-1.44-7.557-5.631-10.647z"></path>
                                 </svg>
                             </div>
                             <nav class="popup-window " style="background-color:#333">

                                 <ul class="align-items-md-center">
                                     <li>
                                         @*<button data-toggle="modal" data-target="#updateProfileModal" class="btn text-white" style="background-color: #55acee;">
                                <i class="fas fa-user me-1" style="color: #ffffff;"></i>
                                Tài khoản
                            </button>*@
                                         <button style="background-color:#333">
                                             <a class="btn btn-warning open-account-modal2" data-id="@ViewBag.acc_id" role="button">
                                                 <i class="fa-solid fa-user-tie me-1" style="color: #ffffff;"></i>
                                                 Tài khoản
                                             </a>
                                         </button>



                                     </li>
                                     <li>

                                     <li>
                                         <button style="background-color:#333">
                                             <a class="btn btn-primary" data-toggle="modal" data-target="#changePasswordModal" role="button">
                                                 Đổi Mật Khẩu
                                             </a>
                                         </button>
                                     </li>
                                     <li>
                                         <button style="background-color:#333">
                                             <a class="btn text-white" data-mdb-ripple-init style="background-color: crimson;" href="@Url.Action("Logout", "DangNhap")" role="button">
                                                 <i class="fas fa-sign-out-alt me-1" style="color: #ffffff;"></i>
                                                 Đăng xuất
                                             </a>
                                         </button>
                                     </li>

                                 </ul>
                             </nav>
                         </label>

                     }


                 </div>

                <!-- modal Câp nhật thông tin cá nhân bát Đầu  -->
                <div class="modal fade" id="changePasswordModal" tabindex="-1" role="dialog" aria-labelledby="changePasswordModalTitle" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="changePasswordModalTitle">Đổi mật khẩu</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            @using (Html.BeginForm("ChangePassword", "Home", FormMethod.Post, new { id = "changePasswordForm" }))
                            {
                                @Html.AntiForgeryToken()
                                <div class="modal-body">
                                    @{
                                        var errorMessage = TempData["ErrorMessage"] as string;
                                        var successMessage = TempData["SuccessMessage"] as string;
                                    }

                                    @if (!string.IsNullOrEmpty(errorMessage))
                                    {
                                        <div class="alert alert-danger alert-dismissible fade show" role="alert">
                                            @errorMessage
                                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                    }

                                    @if (!string.IsNullOrEmpty(successMessage))
                                    {
                                        <div class="alert alert-success alert-dismissible fade show" role="alert">
                                            @successMessage
                                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                    }
                                    <input name="acc_id" type="hidden" id="changePasswordID" />
                                    <div class="form-group">
                                        <label for="currentPassword">Mật khẩu hiện tại</label>
                                        <input type="password" class="form-control" id="currentPassword" name="currentPassword">
                                        <i class="toggle-password fa fa-eye" id="toggleCurrentPassword"></i>
                                    </div>
                                    <div class="form-group">
                                        <label for="newPassword">Mật khẩu mới</label>
                                        <input type="password" class="form-control" id="newPassword" name="newPassword">
                                        <i class="toggle-password fa fa-eye" id="toggleNewPassword"></i>
                                    </div>
                                    <div class="form-group">
                                        <label for="confirmPassword">Xác nhận mật khẩu</label>
                                        <input type="password" class="form-control" id="confirmPassword" name="confirmNewPassword">
                                        <i class="toggle-password fa fa-eye" id="toggleConfirmPassword"></i>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Đóng</button>
                                    <button type="submit" class="btn btn-primary" onclick="return validateChangePasswordForm()">Đổi mật khẩu</button>
                                </div>
                            }
                        </div>
                    </div>
                </div>
                <!-- modal Câp nhật thông tin cá nhân Kết thúc  -->
                <!-- modal Đổi mật khẩu  Bắt đâu -->
                <!-- Modal Đổi Mật Khẩu -->
                <div class="alert alert-success" role="alert" id="successAlert" style="display:none;">
                    Thao tác thành công!
                </div>
                <div class="alert alert-danger" role="alert" id="errorAlert" style="display:none;">
                    Đã xảy ra lỗi!
                </div>


                <div class="modal fade " id="modalUpdate" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                        <div class="modal-content  ">
                            <div class="modal-header" style="background-image:url(img/ai_suptrangia4.jpg);">
                                <h5 class="modal-title text-dark " id="modalUpdatetitle">Thông tin cá nhân</h5>
                                <button type="button" class="btn-close text-bg-light" data-dismiss="modal" aria-label="Close"></button>
                            </div>
                            @using (Html.BeginForm("UpdateAccount", "Home", FormMethod.Post))
                            {
                                @Html.AntiForgeryToken()
                                <div class="modal-body">
                                    <input name="acc_id" type="hidden" id="editIDACC" />
                                    <div class="col-12 mb-3">
                                        <label for="modalPhone" class="form-label">Số điện thoại</label>
                                        <input type="text" id="modalPhone" name="phone" class="form-control" placeholder="Nhập số điện thoại" required readonly />
                                    </div>
                                    <div class="col-12 mb-3">
                                        <label for="modalFullName" class="form-label">Họ và tên</label>
                                        <input type="text" id="modalFullName" name="fullname" class="form-control" placeholder="Nhập họ và tên" required />
                                    </div>
                                    <div class="col mb-0">
                                        <label for="editEmailAcc" class="form-label">Email</label>
                                        <input type="email" id="editEmailAcc" class="form-control" name="Email" placeholder="xxxx@xxx.xx" required />
                                    </div>
                                    <div class="row g-2">
                                        <div class="col mb-0">
                                            <label for="editDateAcc" class="form-label">Ngày sinh</label>
                                            <input type="date" id="editDateAcc" name="birthday" class="form-control" />
                                        </div>
                                    </div>
                                    <input type="hidden" id="editPassword" name="password" class="form-control" />
                                    <div class="mt-3">
                                        <label for="editBranch" class="form-label">Chi nhánh</label>
                                        <select id="editBranch" name="Branch" class="select2 form-select">
                                            <option disabled>Chọn khu vực</option>
                                            @if (ViewBag.branch != null)
                                            {
                                                foreach (var item in ViewBag.branch)
                                                {
                                                    <option value="@item.Branch_id">@item.Branch_Name</option>
                                                }
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-outline-danger" data-dismiss="modal">Đóng</button>
                                    <button type="submit" class="btn btn-outline-success">Lưu thay đổi</button>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>

        </div>

    </nav>
    <div class="hero" style=" background-image: url('../../img/suptragia11.png');">
        <div class="results-summary-container">
            <div class="confetti">
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
                <div class="confetti-piece"></div>
            </div>


        </div>
        <h1 class="d-inline-flex p-2 " style="">CHÀO MỪNG QUÝ KHÁCH</h1>
        <h3 class="">HIỆN TẠI POINT CỦA BẠN </h3>
        <div class="">
            <div class="d-flex justify-content-center">
                <button class="btn2" type="button">
                    <strong>@ViewBag.UserPoints  điểm</strong>
                    <div id="container-stars">
                        <div id="stars"></div>
                    </div>

                    <div id="glow">
                        <div class="circle2"></div>
                        <div class="circle2"></div>
                    </div>
                </button>
            </div>


        </div>

    </div>
    <div class="container mt-5">

        @RenderBody()


    </div>

    <footer class=" text-center  mt-5" style="background-color:#585555;">
        <!-- Grid container -->
        <div class="container p-4">

            <!-- Section: Social media -->
            <section class="mb-4 ">
                <!-- Facebook -->
                <a class="btn btn-primary btn-floating m-1" style="background-color: #3b5998" href="#!" role="button">
                    <i class="fab fa-facebook-f"></i>
                </a>

                <!-- Twitter -->
                <a class="btn btn-primary btn-floating m-1" style="background-color: #222222" href="#!" role="button">
                    <i class="fab fa-tiktok"></i>
                </a>

                <!-- Google -->
                <a class="btn btn-primary btn-floating m-1" style="background-color: #dd4b39" href="#!" role="button">
                    <i class="fab fa-google"></i>
                </a>




            </section>

            <section class="mb-4">
                <p>

                    <h2 class="badge bg-warning text-wrap" style="font-size: 1.5rem;"> Thực phẩm bổ dưỡng tốt cho sức khỏe</h2>


                </p>
            </section>
            <!-- Section: Text -->
            <!-- Section: Links -->
            <section class="">
                <!--Grid row-->
                <div class="row">
                    <!--Grid column-->
                    <div class="col-lg-4 col-md-6 mb-4 mb-md-0">
                        <h5 class="text-uppercase text-warning">GIỚI THIỆU</h5>

                        <ul class="list-unstyled mb-0" style="font-size: 18px;">
                            <li class="">
                                <a href="#!" class="text-light">Súp truyền thống</a>
                            </li>
                            <li>
                                <a href="#!" class="text-light">Súp hải sản</a>
                            </li>
                            <li>
                                <a href="#!" class="text-light">Súp bắc thảo</a>
                            </li>
                            <li>
                                <a href="#!" class="text-light">Súp bào ngư hải sản</a>
                            </li>
                            <li>
                                <a href="#!" class="text-light">Súp càng cua biển</a>
                            </li>
                            <li>
                                <a href="#!" class="text-light">Súp bào ngư đặc biệt</a>
                            </li>
                        </ul>
                    </div>
                    <!--Grid column-->
                    <!--Grid column-->
                    <div class="col-lg-4 col-md-6 mb-4 mb-md-0" style="font-size: 18px;">
                        <h5 class="text-uppercase text-warning">HOTLINE LIÊN HỆ</h5>

                        <ul class="list-unstyled mb-0">
                            <li>
                                <a href="#!" class="text-light">0563930061 (ALL DAY)</a>
                            </li>
                            <li>
                                <a href="#!" class="text-light"> KẾT NỐI VỚI CHÚNG TÔI</a>
                            </li>
                            <li>
                                <a href="#!" class="text-info">
                                    <img src="https://trangiafnb.com/wp-content/uploads/2016/09/Facebook-200x200-1.jpg" alt=""
                                         style="width: 15%;">
                                </a>
                            </li>
                            <li>
                                <a href="#!" class="text-info">
                                    <img src="https://trangiafnb.com/wp-content/uploads/2022/11/tai-xuong-1-306x400.png" alt=""
                                         style="width: 15%;">
                                </a>
                            </li>
                        </ul>
                    </div>
                    <!--Grid column-->
                    <!--Grid column-->
                    <div class="col-lg-4 col-md-6 mb-4 mb-md-0">
                        <h5 class="text-uppercase text-warning">HỆ THỐNG</h5>

                        <ul class="list-unstyled mb-0 " style="font-size: 18px;">
                            <li>
                                <a href="#!" class="text-light">VĨNH LONG</a>
                            </li>
                            <li>
                                <a href="#!" class="text-light">CẦN THƠ ( sắp ra mắt )</a>
                            </li>
                            <li>
                                <a href="#!" class="text-light">FACEBOOK</a>
                            </li>
                            <li>

                            </li>
                        </ul>
                    </div>
                    <!--Grid column-->
                    <!--Grid column-->
                    <!--Grid column-->
                </div>
                <!--Grid row-->
            </section>
            <!-- Section: Links -->

        </div>
        <!-- Grid container -->
        <!-- Copyright -->
        <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2)">
            Copyright 2024 ©
            <a class="text-warning" href="https://mdbootstrap.com/">Súp Trần Gia HOTLINE LIÊN HỆ 0563930061 </a>
        </div>
        <!-- Copyright -->

    </footer>





    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- jQuery -->
    <!-- Bootstrap Bundle with Popper -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>


    <!-- MDB -->
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.3.2/mdb.umd.min.js"></script>

    <!-- Active js -->
    <script src="~/js/active.js"></script>

    <script src="~/js/quantityUp.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    @section Scripts {
        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.5.1.min.js"></script>
        <script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.19.2/jquery.validate.min.js"></script>
        <script src="https://ajax.aspnetcdn.com/ajax/mvc/5.2.3/jquery.validate.unobtrusive.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script>




  $(document).ready(function () {
        // Show modal if there's an error or success message
        if ('@TempData["ErrorMessage"]' || '@TempData["SuccessMessage"]') {
            $('#changePasswordModal').modal('show');
        }

        // Clear alerts on modal hide
        $('#changePasswordModal').on('hidden.bs.modal', function () {
            $(this).find('.alert').remove();
        });

        // Clear alerts on close button click
        $(document).on('click', '.alert .close', function () {
            $(this).parent().remove();
        });
    });










        </script>

        <script>


            document.getElementById('changePasswordForm').addEventListener('submit', function (event) {
                var isValid = true;

                var currentPassword = document.getElementById('currentPassword').value;
                var newPassword = document.getElementById('newPassword').value;
                var confirmNewPassword = document.getElementById('confirmNewPassword').value;

                document.getElementById('currentPasswordError').textContent = '';
                document.getElementById('newPasswordError').textContent = '';
                document.getElementById('confirmNewPasswordError').textContent = '';

                if (!currentPassword) {
                    document.getElementById('currentPasswordError').textContent = 'Mật khẩu hiện tại là bắt buộc.';
                    isValid = false;
                }
                if (!newPassword) {
                    document.getElementById('newPasswordError').textContent = 'Mật khẩu mới là bắt buộc.';
                    isValid = false;
                }
                if (newPassword !== confirmNewPassword) {
                    document.getElementById('confirmNewPasswordError').textContent = 'Mật khẩu mới và xác nhận mật khẩu mới không khớp.';
                    isValid = false;
                }

                if (!isValid) {
                    event.preventDefault();
                }
            });
        </script>
    }
    <script>
        $(document).ready(function () {
            var errorMessage = '@TempData["ErrorMessage"]';
            var successMessage = '@TempData["SuccessMessage"]';

            if (errorMessage) {
                Swal.fire({
                    icon: 'error',
                    title: errorMessage,

                });
            }

            if (successMessage) {
                Swal.fire({
                    icon: 'success',
                    title: successMessage,

                });
            }

            function togglePasswordVisibility(inputId, toggleId) {
                const passwordInput = document.getElementById(inputId);
                const toggleIcon = document.getElementById(toggleId);

                toggleIcon.addEventListener('click', function () {
                    const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                    passwordInput.setAttribute('type', type);
                    this.classList.toggle('fa-eye-slash');
                });
            }

            togglePasswordVisibility('currentPassword', 'toggleCurrentPassword');
            togglePasswordVisibility('newPassword', 'toggleNewPassword');
            togglePasswordVisibility('confirmPassword', 'toggleConfirmPassword');
        });

        function validateChangePasswordForm() {
            var currentPassword = document.getElementById("currentPassword").value;
            var newPassword = document.getElementById("newPassword").value;
            var confirmPassword = document.getElementById("confirmPassword").value;

            if (!currentPassword) {
                Swal.fire({
                    icon: 'error',
                    title: 'Lỗi',
                    text: 'Vui lòng nhập mật khẩu hiện tại.',
                });
                return false;
            }
            if (!newPassword) {
                Swal.fire({
                    icon: 'error',
                    title: 'Lỗi',
                    text: 'Vui lòng nhập mật khẩu mới.',
                });
                return false;
            }
            if (!confirmPassword) {
                Swal.fire({
                    icon: 'error',
                    title: 'Lỗi',
                    text: 'Vui lòng xác nhận mật khẩu mới.',
                });
                return false;
            }
            if (newPassword !== confirmPassword) {
                Swal.fire({
                    icon: 'error',
                    title: 'Lỗi',
                    text: 'Mật khẩu mới và xác nhận mật khẩu không khớp.',
                });
                return false;
            }
            return true;
        }
    </script>
    <script>
    $(document).ready(function () {
     $('.open-account-modal2').click(function () {
         var id = $(this).data('id');
         $.ajax({
             url: '@Url.Action("GetAccount", "Home")',
             type: 'GET',
             data: { id: id },
             success: function (data) {
                 $('#editIDACC').val(data.ID);
                 $('#modalPhone').val(data.Phone);
                 $('#modalFullName').val(data.FullName);
                 $('#editEmailAcc').val(data.EmailAcc);
                 $('#editDateAcc').val(data.Birthday);
               /*  $('#editPassword').val(data.Password);*/

                 $('#editBranch').val(data.BranchAcc);
                // $('#editStatus').prop('checked', true);
                 // Đặt checked = true
                // $('#editStatus').prop('checked', true);
                // $('#editStatus').val(true);
                 // Đặt checked = false
               //  $('#editStatus').prop('checked', false);
                // $('#editStatus').val(false);

                 $('#modalUpdate').modal('show');
             },
             error: function () {
                 alert('Có lỗi xảy ra.');
             }
         });
     });
    });


    </script>

   
  




    @Scripts.Render("~/js/main.js")
    @RenderSection("Scripts", required: false)
</body>
</html>
